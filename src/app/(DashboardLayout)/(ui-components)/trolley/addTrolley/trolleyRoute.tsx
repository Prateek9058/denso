import React, { useState, useRef, useEffect } from 'react';
import { Grid, Paper, Button, Box } from '@mui/material';
import {
    MapContainer,
    ImageOverlay,
    Marker,
    Polyline,
    useMapEvents,
} from 'react-leaflet';
import DeleteIcon from '@mui/icons-material/Delete';
import L from 'leaflet';
import 'leaflet/dist/leaflet.css';

type Point = [number, number];

interface PointWithMarker {
    x: number;
    y: number;
    showMarker: boolean;
}
interface TrolleyRouteProps {
    points: PointWithMarker[];
    setPoints: React.Dispatch<React.SetStateAction<PointWithMarker[]>>;
}

const allowedCoordinates: Point[] = [
    [
        75.01875019073486,
        20.804670666783508
    ],
    [
        72.64375019073486,
        20.679714284238756
    ],
    [
        70.08125019073486,
        20.804670666783508
    ],
    [
        68.33125019073486,
        19.242715884974075
    ],
    [
        65.83125019073486,
        19.1802376937017
    ],
    [
        63.95625019073486,
        19.117759502429315
    ],
    [
        61.95625019073486,
        19.05528131115694
    ],
    [
        62.14375019073486,
        24.05353661294714
    ],
    [
        62.08125019073486,
        26.55266426384223
    ],
    [
        55.51875019073486,
        28.676922767103065
    ],
    [
        52.89375019073486,
        28.61444457583069
    ],
    [
        47.95625019073486,
        30.676224887819146
    ],
    [
        47.76875019073486,
        32.300657860900955
    ],
    [
        50.08125019073486,
        32.11322328708383
    ],
    [
        53.01875019073486,
        32.1757014783562
    ],
    [
        55.64375019073486,
        32.1757014783562
    ],
    [
        62.20625019073486,
        32.23817966962858
    ],
    [
        60.20625019073486,
        32.1757014783562
    ],
    [
        56.95625019073486,
        36.79908763251214
    ],
    [
        54.70625019073486,
        36.73660944123976
    ],
    [
        62.08125019073486,
        34.54987274670654
    ],
    [
        62.01875019073486,
        36.79908763251213
    ],
    [
        59.83125019073486,
        36.79908763251213
    ],
    [
        52.51875019073486,
        36.86156582378451
    ],
    [
        50.45625019073486,
        36.92404401505689
    ],
    [
        47.89375019073486,
        34.175003599072284
    ],
    [
        47.89375019073486,
        39.36069347467961
    ],
    [
        47.95625019073486,
        41.48495197794044
    ],
    [
        47.89375019073486,
        43.29681952483939
    ],
    [
        50.58125019073486,
        45.23364345428309
    ],
    [
        52.45625019073486,
        45.35859983682785
    ],
    [
        54.51875019073486,
        45.35859983682785
    ],
    [
        56.64375019073486,
        45.23364345428309
    ],
    [
        59.08125019073486,
        45.35859983682785
    ],
    [
        62.01875019073486,
        38.92334613577297
    ],
    [
        62.08125019073486,
        40.79769187394429
    ],
    [
        62.08125019073486,
        42.73451580338799
    ],
    [
        62.20625019073486,
        47.35790195754392
    ],
    [
        62.08125019073486,
        49.794551417166645
    ],
    [
        62.14375019073486,
        52.543591833151254
    ],
    [
        62.10312509536743,
        54.77144697693367
    ],
    [
        62.07187509536743,
        56.395879950015484
    ],
    [
        62.07187509536743,
        57.86411744491635
    ],
    [
        62.16562509536743,
        59.20739855727247
    ],
    [
        60.44687509536743,
        61.26917886926093
    ],
    [
        58.85312509536743,
        61.20670067798855
    ],
    [
        57.44687509536743,
        61.26917886926093
    ],
    [
        56.13437509536743,
        61.23793977362473
    ],
    [
        54.54062509536743,
        61.20670067798855
    ],
    [
        53.00937509536743,
        61.26917886926093
    ],
    [
        51.38437509536743,
        61.14422248671617
    ],
    [
        48.00937509536743,
        61.26917886926093
    ],
    [
        47.97812509536743,
        47.305303119884556
    ],
    [
        47.94687509536743,
        46.27441296389033
    ],
    [
        47.85312509536743,
        48.27371508460641
    ],
    [
        47.82187509536743,
        49.30460524060064
    ],
    [
        47.94687509536743,
        50.11682172714154
    ],
    [
        47.88437509536743,
        51.17895097877196
    ],
    [
        47.85312509536743,
        52.17860203913
    ],
    [
        47.91562509536743,
        54.45905602057178
    ],
    [
        47.79062509536743,
        55.89605441983646
    ],
    [
        47.88437509536743,
        57.30181372346495
    ],
    [
        47.79062509536743,
        58.77005121836582
    ],
    [
        47.72812509536743,
        60.14457142635813
    ],
    [
        47.97812509536743,
        62.893611842342736
    ],
    [
        46.91562509536743,
        63.01856822488749
    ],
    [
        47.91562509536743,
        63.8307847114284
    ],
    [
        47.94687509536743,
        65.08034853687595
    ],
    [
        47.82187509536743,
        66.2986732666873
    ],
    [
        47.82187509536743,
        67.735671665952
    ],
    [
        49.16562509536743,
        45.21228371225991
    ],
    [
        48.16562509536743,
        45.18104461662372
    ],
    [
        47.88437509536743,
        44.243871747538066
    ],
    [
        47.47812509536743,
        53.45940496021374
    ],
    [
        46.25937509536743,
        53.521883151486115
    ],
    [
        50.04062509536743,
        61.23793977362473
    ],
    [
        48.88437509536743,
        61.175461582352355
    ],
    [
        47.82187509536743,
        62.14387354707421
    ],
    [
        48.88437509536743,
        71.60931952483939
    ],
    [
        48.07187509536743,
        70.39227060559395
    ],
    [
        47.97812509536743,
        72.7352027783081
    ],
    [
        47.82187509536743,
        71.391921665952
    ],
    [
        46.72812509536743,
        71.3606825703158
    ],
    [
        49.41562509536743,
        83.91879901606367
    ],
    [
        47.97812509536743,
        83.8563208247913
    ],
    [
        47.94687509536743,
        81.95073599098379
    ],
    [
        48.04062509536743,
        82.95038705134182
    ],
    [
        48.63437509536743,
        83.95003811169987
    ],
    [
        47.97812509536743,
        84.6997764069684
    ],
    [
        47.94687509536743,
        85.73066656296263
    ],
    [
        47.41562509536743,
        88.07359873567678
    ],
    [
        47.79062509536743,
        88.94829341349006
    ],
    [
        48.00937509536743,
        87.04270857968255
    ],
    [
        46.10312509536743,
        88.19855511822153
    ],
    [
        49.10312509536743,
        93.69663595019075
    ],
    [
        48.32187509536743,
        93.66539685455456
    ],
    [
        48.00937509536743,
        92.79070217674128
    ],
    [
        47.94687509536743,
        94.79000429745736
    ],
    [
        46.85312509536743,
        98.03887024362098
    ],
    [
        47.88437509536743,
        96.35195907926679
    ],
    [
        47.88437509536743,
        99.53834683415803
    ],
    [
        47.85312509536743,
        103.56819017122639
    ],
    [
        48.91562509536743,
        104.9114712835825
    ],
    [
        48.10312509536743,
        104.9114712835825
    ],
    [
        48.04062509536743,
        104.16173298831397
    ],
    [
        47.94687509536743,
        105.84864415266817
    ],
    [
        46.88437509536743,
        108.19157632538233
    ],
    [
        47.75937509536743,
        108.19157632538233
    ],
    [
        47.72812509536743,
        107.09820797811571
    ],
    [
        45.79062509536743,
        108.16033722974613
    ],
    [
        47.82187509536743,
        109.37866195955749
    ],
    [
        49.50937509536743,
        116.75108852969804
    ],
    [
        47.94687509536743,
        116.00135023442951
    ],
    [
        48.04062509536743,
        117.78197868569227
    ],
    [
        47.25937509536743,
        116.87604491224279
    ],
    [
        46.41562509536743,
        117.03224039042374
    ],
    [
        47.97812509536743,
        116.78232762533423
    ],
    [
        48.79062509536743,
        116.87604491224279
    ],
    [
        46.75937509536743,
        125.49803530783089
    ],
    [
        47.97812509536743,
        126.8100773245508
    ],
    [
        47.97812509536743,
        123.99855871729383
    ],
    [
        49.32187509536743,
        135.21339405068557
    ],
    [
        48.35312509536743,
        135.21339405068557
    ],
    [
        48.00937509536743,
        133.83887384269326
    ],
    [
        48.00937509536743,
        136.36924058922455
    ],
    [
        49.54062509536743,
        140.1491711612034
    ],
    [
        48.00937509536743,
        138.86836824011965
    ],
    [
        48.00937509536743,
        141.33625679537857
    ],
    [
        48.35312509536743,
        140.08669296993102
    ],
    [
        48.94687509536743,
        125.49803530783089
    ],
    [
        47.91562509536743,
        125.46764865925506
    ],
    [
        49.50937509536743,
        149.11564405584994
    ],
    [
        48.38437509536743,
        149.1781222471223
    ],
    [
        48.00937509536743,
        147.70988475222146
    ],
    [
        48.16562509536743,
        150.5526424551146
    ],
    [
        49.75937509536743,
        158.17498179034467
    ],
    [
        48.69687509536743,
        158.26869907725325
    ],
    [
        47.85312509536743,
        157.2690480168952
    ],
    [
        47.94687509536743,
        159.11215465943033
    ],
    [
        47.69687509536743,
        178.43115366026183
    ],
    [
        47.69687509536743,
        179.46204381625608
    ],
    [
        46.85312509536743,
        179.61823929443702
    ],
    [
        48.54062509536743,
        179.6807174857094
    ],
    [
        49.69687509536743,
        180.08682572897985
    ],
    [
        45.66562509536743,
        179.83691296389034
    ],
    [
        74.69687509536743,
        134.8725029006872
    ],
    [
        72.72812509536743,
        135.1848938570491
    ],
    [
        74.85312509536743,
        136.96552230831185
    ],
    [
        73.91562509536743,
        143.58821058318387
    ],
    [
        74.72812509536743,
        143.61944967882008
    ],
    [
        72.32187509536743,
        143.58821058318387
    ],
    [
        73.82187509536743,
        150.14842066678352
    ],
    [
        74.41562509536743,
        150.08594247551113
    ],
    [
        72.41562509536743,
        150.14842066678352
    ],
    [
        61.19687509536743,
        28.556426269357125
    ],
    [
        61.82187509536743,
        28.556426269357125
    ],
    [
        62.07187509536743,
        29.93094647734943
    ],
    [
        62.19687509536743,
        31.180510302796982
    ],
    [
        62.10312509536743,
        27.556775208999085
    ],
    [
        57.75937509536743,
        28.556426269357125
    ],
    [
        59.69687509536743,
        28.556426269357125
    ],
    [
        50.19687509536743,
        28.587665364993313
    ],
    [
        48.79062509536743,
        28.587665364993313
    ],
    [
        48.00937509536743,
        29.74436244390958
    ],
    [
        47.94687509536743,
        26.839126549744023
    ],
    [
        48.63437509536743,
        36.8981153445968
    ],
    [
        47.91562509536743,
        36.96059353586918
    ],
    [
        47.94687509536743,
        38.053961883135784
    ],
    [
        47.97812509536743,
        35.64855151914925
    ],
    [
        51.72812509536743,
        28.682233192279156
    ],
    [
        51.88437509536743,
        32.21225099916849
    ],
    [
        54.19687509536743,
        32.11853371225992
    ],
    [
        54.19687509536743,
        28.557276809734404
    ],
    [
        56.85312509536743,
        28.46355952282584
    ],
    [
        57.88437509536743,
        32.21225099916849
    ],
    [
        56.85312509536743,
        32.181011903532294
    ],
    [
        60.63437509536743,
        45.27019297509538
    ],
    [
        61.41562509536743,
        45.23895387945919
    ],
    [
        62.07187509536743,
        45.17647568818681
    ],
    [
        50.00937509536743,
        18.966874449424466
    ],
    [
        47.97812509536743,
        18.77943987560733
    ],
    [
        45.94687509536743,
        19.029352640696843
    ],
    [
        47.04062509536743,
        18.966874449424466
    ],
    [
        47.97812509536743,
        19.716612744692995
    ],
    [
        48.82187509536743,
        18.77943987560733
    ],
    [
        47.94687509536743,
        20.5288292312339
    ],
    [
        47.88437509536743,
        21.434763004683376
    ],
    [
        47.94687509536743,
        23.152913264673757
    ],
    [
        47.79062509536743,
        25.027259002845078
    ],
    [
        60.60312509536743,
        19.06059173633303
    ],
    [
        59.44687509536743,
        19.09183083196922
    ],
    [
        58.07187509536743,
        18.93563535378827
    ],
    [
        56.72812509536743,
        18.873157162515895
    ],
    [
        55.47812509536743,
        18.748200779971143
    ],
    [
        66.94687509536743,
        19.123069927605407
    ],
    [
        69.00937509536743,
        20.153960083599635
    ],
    [
        71.63437509536743,
        20.716263805051035
    ],
    [
        74.22812509536743,
        20.747502900687223
    ],
    [
        73.50937509536743,
        20.62254651814247
    ],
    [
        70.91562509536743,
        20.8099810919596
    ],
    [
        65.00937509536743,
        19.24802631015016
    ],
    [
        63.07187509536743,
        19.029352640696843
    ],
    [
        62.04062509536743,
        19.904047318510123
    ],
    [
        62.13437509536743,
        20.5288292312339
    ],
    [
        62.25937509536743,
        21.184850239593864
    ],
    [
        62.16562509536743,
        21.934588534862392
    ],
    [
        62.22812509536743,
        23.12167416903756
    ],
    [
        62.07187509536743,
        25.214693576662214
    ],
    [
        54.16562509536743,
        18.935635353788278
    ],
    [
        52.85312509536743,
        19.060591736333038
    ],
    [
        51.44687509536743,
        18.841918066879714
    ],
    [
        44.41562509536743,
        19.056099138442796
    ],
    [
        43.13437509536743,
        19.14981642535136
    ],
    [
        41.66562509536743,
        19.087338234078985
    ],
    [
        40.19687509536743,
        19.056099138442796
    ],
    [
        38.75937509536743,
        19.087338234078985
    ],
    [
        37.04062509536743,
        19.14981642535136
    ],
    [
        35.82187509536743,
        19.18105552098754
    ],
    [
        34.54062509536743,
        19.14981642535136
    ],
    [
        32.91562509536743,
        19.212294616623737
    ],
    [
        31.91562509536743,
        19.212294616623737
    ],
    [
        29.75937509536743,
        19.14981642535136
    ],
    [
        30.60312509536743,
        20.368141155162718
    ],
    [
        30.63437509536743,
        21.305314024248382
    ],
    [
        30.47812509536743,
        19.243533712259925
    ],
    [
        30.57187509536743,
        19.774598338075137
    ],
    [
        31.16562509536743,
        19.14981642535136
    ],
    [
        30.57187509536743,
        20.836727589705546
    ],
    [
        31.97812509536743,
        28.521545116207975
    ],
    [
        31.22812509536743,
        28.615262403116546
    ],
    [
        30.75937509536743,
        27.178264003851865
    ],
    [
        30.82187509536743,
        30.114738993653603
    ],
    [
        30.75937509536743,
        27.93069567698177
    ],
    [
        29.97812509536743,
        29.117781311156946
    ],
    [
        29.47812509536743,
        29.149020406793134
    ],
    [
        30.57187509536743,
        28.961585832976
    ],
    [
        32.22812509536743,
        37.23994617656602
    ],
    [
        31.38437509536743,
        37.20870708092983
    ],
    [
        30.94687509536743,
        36.30277330748036
    ],
    [
        30.72812509536743,
        37.23994617656602
    ],
    [
        30.85312509536743,
        38.33331452383263
    ],
    [
        29.97812509536743,
        38.708183671466884
    ],
    [
        29.38437509536743,
        38.801900958375455
    ],
    [
        30.75937509536743,
        39.30172648855448
    ],
    [
        30.85312509536743,
        31.710626248960608
    ],
    [
        30.72812509536743,
        32.80399459622721
    ],
    [
        30.75937509536743,
        33.959841134766194
    ],
    [
        30.69687509536743,
        35.17816586457756
    ],
    [
        38.41562509536743,
        37.02127250711269
    ],
    [
        36.85312509536743,
        37.14622888965745
    ],
    [
        35.50937509536743,
        37.17746798529363
    ],
    [
        34.22812509536743,
        37.20870708092983
    ],
    [
        33.22812509536743,
        37.20870708092983
    ],
    [
        40.82187509536743,
        37.08375069838507
    ],
    [
        46.82187509536743,
        37.20870708092982
    ],
    [
        44.16562509536743,
        37.02127250711269
    ],
    [
        45.57187509536743,
        37.08375069838507
    ],
    [
        42.91562509536743,
        37.08375069838507
    ],
    [
        41.91562509536743,
        37.08375069838507
    ],
    [
        39.69687509536743,
        37.14622888965744
    ],
    [
        47.16562509536743,
        44.79980732052368
    ],
    [
        45.63437509536743,
        44.79980732052368
    ],
    [
        43.94687509536743,
        44.79980732052368
    ],
    [
        47.91562509536743,
        45.768219285245536
    ],
    [
        47.04062509536743,
        53.453036811747964
    ],
    [
        48.00937509536743,
        53.296841333567016
    ],
    [
        45.00937509536743,
        53.48427590738415
    ],
    [
        43.66562509536743,
        53.421797716111776
    ],
    [
        41.88437509536743,
        53.577993194292716
    ],
    [
        40.16562509536743,
        53.48427590738415
    ],
    [
        38.25937509536743,
        53.453036811747964
    ],
    [
        36.32187509536743,
        53.453036811747964
    ],
    [
        34.54062509536743,
        53.51551500302034
    ],
    [
        32.82187509536743,
        53.48427590738416
    ],
    [
        31.41562509536743,
        53.421797716111776
    ],
    [
        30.94687509536743,
        53.39055862047559
    ],
    [
        30.82187509536743,
        52.17223389066423
    ],
    [
        30.82187509536743,
        54.608883350286945
    ],
    [
        30.19687509536743,
        55.70225169755355
    ],
    [
        29.75937509536743,
        55.70225169755355
    ],
    [
        30.63437509536743,
        55.63977350628117
    ],
    [
        30.72812509536743,
        56.63942456663922
    ],
    [
        32.16562509536743,
        44.73732912925131
    ],
    [
        31.41562509536743,
        44.768568224887495
    ],
    [
        30.91562509536743,
        44.768568224887495
    ],
    [
        30.85312509536743,
        46.080610241607424
    ],
    [
        30.88437509536743,
        43.26909163435044
    ],
    [
        30.82187509536743,
        41.332267704906734
    ],
    [
        30.75937509536743,
        50.76647458703573
    ],
    [
        30.13437509536743,
        46.892826728148336
    ],
    [
        30.75937509536743,
        49.42398949323784
    ],
    [
        30.75937509536743,
        57.8585453150088
    ],
    [
        30.75937509536743,
        59.38926100118204
    ],
    [
        30.69687509536743,
        60.60758573099341
    ],
    [
        30.72812509536743,
        61.794671365168576
    ],
    [
        30.07187509536743,
        61.825910460804764
    ],
    [
        32.97812509536743,
        63.16919157316088
    ],
    [
        31.44687509536743,
        63.106713381888504
    ],
    [
        30.75937509536743,
        63.98140805970179
    ],
    [
        32.10312509536743,
        63.04423519061612
    ],
    [
        36.29062509536743,
        62.91927880807137
    ],
    [
        34.97812509536743,
        62.981756999343744
    ],
    [
        30.72812509536743,
        62.76308332989043
    ],
    [
        30.60312509536743,
        69.79187984803289
    ],
    [
        29.97812509536743,
        69.82311894366909
    ],
    [
        30.72812509536743,
        70.66657452584617
    ],
    [
        30.72812509536743,
        68.60479421385773
    ],
    [
        31.47812509536743,
        71.32259553420614
    ],
    [
        32.10312509536743,
        71.1664000560252
    ],
    [
        30.75937509536743,
        71.54126920365945
    ],
    [
        30.75937509536743,
        73.16570217674128
    ],
    [
        34.60312509536743,
        71.22887824729757
    ],
    [
        33.44687509536743,
        71.19763915166139
    ],
    [
        36.63437509536743,
        71.1664000560252
    ],
    [
        45.38437509536743,
        63.075474286252316
    ],
    [
        44.25937509536743,
        63.20043066879707
    ],
    [
        42.60312509536743,
        63.04423519061612
    ],
    [
        40.72812509536743,
        63.075474286252316
    ],
    [
        38.79062509536743,
        63.01299609497994
    ],
    [
        37.38437509536743,
        62.950517903707556
    ],
    [
        45.41562509536743,
        71.47879101238709
    ],
    [
        43.91562509536743,
        71.29135643856995
    ],
    [
        42.50937509536743,
        71.29135643856995
    ],
    [
        40.94687509536743,
        71.1664000560252
    ],
    [
        39.57187509536743,
        71.29135643856995
    ],
    [
        38.50937509536743,
        71.29135643856995
    ],
    [
        47.85312509536743,
        69.10461974403674
    ],
    [
        47.91562509536743,
        74.88385243673166
    ],
    [
        47.88437509536743,
        73.85296228073743
    ],
    [
        47.94687509536743,
        76.19589445345159
    ],
    [
        47.85312509536743,
        77.60165375708007
    ],
    [
        47.22812509536743,
        79.38228220834283
    ],
    [
        47.63437509536743,
        79.25732582579808
    ],
    [
        48.00937509536743,
        78.60130481743812
    ],
    [
        47.94687509536743,
        80.0383032167028
    ],
    [
        47.88437509536743,
        81.1316715639694
    ],
    [
        50.79062509536743,
        83.94319017122639
    ],
    [
        52.50937509536743,
        83.94319017122639
    ],
    [
        53.94687509536743,
        83.88071197995401
    ],
    [
        55.60312509536743,
        84.00566836249877
    ],
    [
        56.69687509536743,
        83.94319017122639
    ],
    [
        57.57187509536743,
        83.78699469304544
    ],
    [
        58.57187509536743,
        83.78699469304544
    ],
    [
        59.66562509536743,
        83.78699469304544
    ],
    [
        60.88437509536743,
        83.81823378868164
    ],
    [
        62.10312509536743,
        81.6939752854208
    ],
    [
        61.47812509536743,
        83.78699469304544
    ],
    [
        62.10312509536743,
        85.66283432905891
    ],
    [
        62.13437509536743,
        86.56876810250839
    ],
    [
        62.07187509536743,
        87.94328831050069
    ],
    [
        62.07187509536743,
        89.44276490103775
    ],
    [
        62.13437509536743,
        82.72635933925717
    ],
    [
        62.25937509536743,
        84.78813965124563
    ],
    [
        62.16562509536743,
        83.7260103996152
    ],
    [
        61.32187509536743,
        79.25881972364022
    ],
    [
        61.88437509536743,
        79.19634153236784
    ],
    [
        62.00937509536743,
        80.25847078399826
    ],
    [
        60.13437509536743,
        79.19634153236784
    ],
    [
        59.07187509536743,
        79.19634153236784
    ],
    [
        58.13437509536743,
        79.19634153236784
    ],
    [
        57.00937509536743,
        79.22758062800403
    ],
    [
        55.88437509536743,
        79.19634153236784
    ],
    [
        54.66562509536743,
        79.16510243673166
    ],
    [
        54.25937509536743,
        71.48028491022923
    ],
    [
        55.47812509536743,
        71.57400219713779
    ],
    [
        56.72812509536743,
        71.57400219713779
    ],
    [
        57.88437509536743,
        71.57400219713779
    ],
    [
        58.97812509536743,
        71.57400219713779
    ],
    [
        60.25937509536743,
        71.57400219713779
    ],
    [
        61.38437509536743,
        71.57400219713779
    ],
    [
        62.04062509536743,
        70.26196018041787
    ],
    [
        62.04062509536743,
        72.82356602258534
    ],
    [
        62.04062509536743,
        71.60524129277398
    ],
    [
        62.13437509536743,
        74.16684713494146
    ],
    [
        62.00937509536743,
        75.29145457784425
    ],
    [
        62.00937509536743,
        76.32234473383848
    ],
    [
        62.13437509536743,
        78.41536414146313
    ],
    [
        62.16562509536743,
        77.44695217674128
    ],
    [
        62.16562509536743,
        80.94573088799442
    ],
    [
        62.13437509536743,
        69.0748745462427
    ],
    [
        62.10312509536743,
        67.73159343388657
    ],
    [
        62.19687509536743,
        66.45079051280284
    ],
    [
        62.16562509536743,
        62.670859940824
    ],
    [
        61.41562509536743,
        61.23386154155932
    ],
    [
        61.94687509536743,
        61.20262244592313
    ],
    [
        62.19687509536743,
        63.889184670635366
    ],
    [
        62.19687509536743,
        61.98359983682785
    ],
    [
        62.25937509536743,
        60.046775907384145
    ],
    [
        62.16562509536743,
        60.609079628835545
    ],
    [
        62.16562509536743,
        65.29494397426386
    ],
    [
        75.29062509536743,
        83.53857582579808
    ],
    [
        74.00937509536743,
        83.41361944325332
    ],
    [
        72.63437509536743,
        83.44485853888952
    ],
    [
        70.97812509536743,
        83.44485853888952
    ],
    [
        69.82187509536743,
        83.44485853888952
    ],
    [
        62.16562509536743,
        88.63054841449684
    ],
    [
        62.22812509536743,
        87.34974549341311
    ],
    [
        60.50937509536743,
        93.62880371628704
    ],
    [
        56.44687509536743,
        93.72252100319561
    ],
    [
        55.25937509536743,
        93.72252100319561
    ],
    [
        53.47812509536743,
        93.72252100319561
    ],
    [
        51.91562509536743,
        93.78499919446799
    ],
    [
        50.32187509536743,
        93.7537600988318
    ],
    [
        57.97812509536743,
        93.72252100319561
    ],
    [
        59.10312509536743,
        93.78499919446799
    ],
    [
        60.94687509536743,
        104.71868266713405
    ],
    [
        59.32187509536743,
        104.71868266713405
    ],
    [
        57.88437509536743,
        104.8436390496788
    ],
    [
        55.91562509536743,
        104.8436390496788
    ],
    [
        54.10312509536743,
        104.874878145315
    ],
    [
        51.97812509536743,
        104.8436390496788
    ],
    [
        50.38437509536743,
        104.8436390496788
    ],
    [
        47.82187509536743,
        100.93875209515521
    ],
    [
        47.75937509536743,
        102.31327230314751
    ],
    [
        47.85312509536743,
        90.06754681376152
    ],
    [
        47.85312509536743,
        91.34834973484527
    ],
    [
        75.25937509536743,
        117.71414645178857
    ],
    [
        73.44687509536743,
        117.71414645178857
    ],
    [
        71.16562509536743,
        117.83910283433332
    ],
    [
        69.04062509536743,
        117.83910283433332
    ],
    [
        67.63437509536743,
        117.90158102560568
    ],
    [
        65.44687509536743,
        117.93282012124189
    ],
    [
        64.04062509536743,
        117.9015810256057
    ],
    [
        62.10312509536743,
        111.09145817691655
    ],
    [
        61.97812509536743,
        112.71589114999836
    ],
    [
        62.04062509536743,
        113.99669407108209
    ],
    [
        62.13437509536743,
        114.74643236635063
    ],
    [
        62.22812509536743,
        115.77732252234486
    ],
    [
        62.22812509536743,
        116.90192996524765
    ],
    [
        61.22812509536743,
        116.96440815652002
    ],
    [
        62.16562509536743,
        117.9015810256057
    ],
    [
        62.22812509536743,
        119.15114485105323
    ],
    [
        62.16562509536743,
        120.30699138959223
    ],
    [
        62.19687509536743,
        121.58779431067596
    ],
    [
        62.16562509536743,
        122.83735813612351
    ],
    [
        62.16562509536743,
        123.83700919648155
    ],
    [
        63.07187509536743,
        117.08936453906477
    ],
    [
        66.47812509536743,
        117.83910283433332
    ],
    [
        58.16562509536743,
        116.83945177397527
    ],
    [
        56.54062509536743,
        116.90192996524765
    ],
    [
        59.75937509536743,
        116.83945177397527
    ],
    [
        54.88437509536743,
        116.83945177397527
    ],
    [
        53.47812509536743,
        116.93316906088384
    ],
    [
        52.22812509536743,
        116.90192996524765
    ],
    [
        50.97812509536743,
        116.87069086961147
    ],
    [
        63.88437509536743,
        135.17680091241806
    ],
    [
        62.13437509536743,
        136.55132112041036
    ],
    [
        62.13437509536743,
        133.86475889569812
    ],
    [
        60.54062509536743,
        135.23927910369042
    ],
    [
        61.38437509536743,
        135.27051819932663
    ],
    [
        61.94687509536743,
        135.27051819932663
    ],
    [
        62.38437509536743,
        135.17680091241806
    ],
    [
        63.00937509536743,
        135.17680091241806
    ],
    [
        71.29062509536743,
        135.17680091241806
    ],
    [
        70.04062509536743,
        135.0830836255095
    ],
    [
        68.66562509536743,
        135.0830836255095
    ],
    [
        67.60312509536743,
        135.14556181678188
    ],
    [
        66.29062509536743,
        135.0830836255095
    ],
    [
        65.16562509536743,
        135.0830836255095
    ],
    [
        74.85312509536743,
        135.83282192077803
    ],
    [
        73.54062509536743,
        135.0830836255095
    ],
    [
        74.75937509536743,
        138.30071047603693
    ],
    [
        74.66562509536743,
        139.64399158839305
    ],
    [
        74.66562509536743,
        141.11222908329393
    ],
    [
        70.66562509536743,
        143.61135673418903
    ],
    [
        74.63437509536743,
        142.2680756218329
    ],
    [
        74.69687509536743,
        145.23578970727084
    ],
    [
        74.69687509536743,
        146.57907081962696
    ],
    [
        74.69687509536743,
        148.01606921889163
    ],
    [
        74.82187509536743,
        149.04695937488586
    ],
    [
        74.85312509536743,
        151.32741335632764
    ],
    [
        74.88437509536743,
        152.545738086139
    ],
    [
        74.82187509536743,
        153.70326389670493
    ],
    [
        74.79062509536743,
        154.92158862651627
    ],
    [
        73.82187509536743,
        156.35858702578096
    ],
    [
        74.32187509536743,
        156.29610883450857
    ],
    [
        74.97812509536743,
        156.2648697388724
    ],
    [
        74.82187509536743,
        157.70186813813706
    ],
    [
        74.85312509536743,
        158.88895377231225
    ],
    [
        74.82187509536743,
        160.10727850212362
    ],
    [
        73.94687509536743,
        163.13747077883392
    ],
    [
        74.38437509536743,
        163.13747077883392
    ],
    [
        74.79062509536743,
        161.32560323193496
    ],
    [
        75.00937509536743,
        163.07499258756155
    ],
    [
        74.72812509536743,
        162.20029790974826
    ],
    [
        74.69687509536743,
        164.0434045522834
    ],
    [
        74.75937509536743,
        165.23049018645855
    ],
    [
        74.72812509536743,
        166.35509762936135
    ],
    [
        74.72812509536743,
        167.47970507226415
    ],
    [
        74.72812509536743,
        168.51059522825838
    ],
    [
        74.72812509536743,
        169.47900719298022
    ],
    [
        74.72812509536743,
        170.60361463588302
    ],
    [
        74.69687509536743,
        171.6969829831496
    ],
    [
        74.69687509536743,
        172.97778590423337
    ],
    [
        74.69687509536743,
        174.35230611222568
    ],
    [
        74.75937509536743,
        175.4302485980655
    ],
    [
        74.75937509536743,
        176.74229061478542
    ],
    [
        74.75937509536743,
        177.71070257950728
    ],
    [
        74.66562509536743,
        180.7408948562176
    ],
    [
        74.10312509536743,
        180.7721339518538
    ],
    [
        73.69687509536743,
        180.7721339518538
    ],
    [
        74.69687509536743,
        182.02169777730134
    ],
    [
        74.72812509536743,
        178.80407092677387
    ],
    [
        74.79062509536743,
        179.74124379585956
    ],
    [
        74.72812509536743,
        183.39621798529365
    ],
    [
        74.66562509536743,
        185.23932462782878
    ],
    [
        74.63437509536743,
        187.33234403545342
    ],
    [
        74.66562509536743,
        189.23792886926094
    ],
    [
        74.66562509536743,
        191.95573018960937
    ],
    [
        74.72812509536743,
        194.14246688414258
    ],
    [
        74.79062509536743,
        196.0168126223139
    ],
    [
        74.82187509536743,
        197.7037237866681
    ],
    [
        74.88437509536743,
        200.3902860113803
    ],
    [
        89.13437509536743,
        200.17650840127826
    ],
    [
        87.44687509536743,
        200.20774749691444
    ],
    [
        85.88437509536743,
        200.20774749691444
    ],
    [
        84.07187509536743,
        200.36394297509537
    ],
    [
        82.04062509536743,
        200.39518207073155
    ],
    [
        80.97812509536743,
        200.52013845327633
    ],
    [
        79.69687509536743,
        200.45766026200394
    ],
    [
        78.07187509536743,
        200.42642116636773
    ],
    [
        76.57187509536743,
        200.48889935764012
    ],
    [
        74.82187509536743,
        199.11437914964782
    ],
    [
        74.66562509536743,
        201.6759849918153
    ],
    [
        74.63437509536743,
        203.23985894165554
    ],
    [
        74.66562509536743,
        204.6768573409202
    ],
    [
        74.60312509536743,
        205.95766026200394
    ],
    [
        74.63437509536743,
        207.30094137436006
    ],
    [
        74.63437509536743,
        208.76917886926094
    ],
    [
        74.63437509536743,
        209.6438735470742
    ],
    [
        74.72812509536743,
        190.46306882645433
    ],
    [
        74.63437509536743,
        188.3388103231935
    ],
    [
        74.63437509536743,
        186.433225489386
    ],
    [
        74.63437509536743,
        184.43392336866992
    ],
    [
        62.08125019073486,
        125.03558803011381
    ],
    [
        62.08125019073486,
        126.53506462065087
    ],
    [
        62.79062509536743,
        126.55487784969591
    ],
    [
        62.19687509536743,
        127.71072438823492
    ],
    [
        61.38437509536743,
        125.52488185153422
    ],
    [
        62.07187509536743,
        125.77479461662372
    ],
    [
        60.25937509536743,
        125.46240366026186
    ],
    [
        59.00937509536743,
        125.46240366026186
    ],
    [
        58.00937509536743,
        125.46240366026186
    ],
    [
        56.54062509536743,
        125.46240366026186
    ],
    [
        55.07187509536743,
        125.49364275589804
    ],
    [
        53.91562509536743,
        125.49364275589804
    ],
    [
        52.47812509536743,
        125.39992546898947
    ],
    [
        50.69687509536743,
        125.52488185153422
    ],
    [
        51.85312509536743,
        135.2714796900251
    ],
    [
        50.54062509536743,
        135.24024059438892
    ],
    [
        53.88437509536743,
        135.17776240311653
    ],
    [
        55.88437509536743,
        135.2714796900251
    ],
    [
        59.16562509536743,
        135.2714796900251
    ],
    [
        57.69687509536743,
        135.2714796900251
    ],
    [
        62.13437509536743,
        137.86432462782878
    ],
    [
        62.19687509536743,
        139.11388845327633
    ],
    [
        61.29062509536743,
        140.17601770490674
    ],
    [
        61.88437509536743,
        140.0198222267258
    ],
    [
        62.13437509536743,
        141.1131905739924
    ],
    [
        62.13437509536743,
        142.33151530380377
    ],
    [
        62.16562509536743,
        143.70603551179607
    ],
    [
        63.10312509536743,
        143.73727460743225
    ],
    [
        64.16562509536743,
        143.51860093797893
    ],
    [
        62.13437509536743,
        145.11179481542456
    ],
    [
        62.13437509536743,
        146.61127140596162
    ],
    [
        62.13437509536743,
        147.7671179445006
    ],
    [
        61.54062509536743,
        149.1728772481291
    ],
    [
        62.88437509536743,
        150.14128921285095
    ],
    [
        62.19687509536743,
        149.61022458703576
    ],
    [
        62.13437509536743,
        148.76676900485865
    ],
    [
        62.19687509536743,
        150.64111474302996
    ],
    [
        60.32187509536743,
        149.2041163437653
    ],
    [
        56.97812509536743,
        149.07915996122054
    ],
    [
        58.82187509536743,
        149.07915996122054
    ],
    [
        55.25937509536743,
        149.1728772481291
    ],
    [
        53.13437509536743,
        149.26659453503765
    ],
    [
        51.35312509536743,
        149.04792086558436
    ],
    [
        69.00937509536743,
        143.68186244390958
    ],
    [
        67.35312509536743,
        143.6506233482734
    ],
    [
        65.79062509536743,
        143.55690606136483
    ],
    [
        70.85312509536743,
        150.14835524060064
    ],
    [
        69.25937509536743,
        150.14835524060064
    ],
    [
        67.66562509536743,
        150.11711614496446
    ],
    [
        65.66562509536743,
        150.14835524060064
    ],
    [
        64.10312509536743,
        150.05463795369207
    ],
    [
        72.54062509536743,
        156.3961743678384
    ],
    [
        71.38437509536743,
        156.3961743678384
    ],
    [
        69.72812509536743,
        156.3961743678384
    ],
    [
        68.13437509536743,
        156.333696176566
    ],
    [
        66.41562509536743,
        156.333696176566
    ],
    [
        64.47812509536743,
        156.333696176566
    ],
    [
        62.07187509536743,
        152.2101355525891
    ],
    [
        62.07187509536743,
        153.39722118676428
    ],
    [
        62.97812509536743,
        156.3961743678384
    ],
    [
        62.35312509536743,
        156.42741346347458
    ],
    [
        61.57187509536743,
        158.2705201060097
    ],
    [
        60.91562509536743,
        158.23928101037353
    ],
    [
        62.19687509536743,
        159.36388845327633
    ],
    [
        62.10312509536743,
        157.39582542819645
    ],
    [
        62.13437509536743,
        154.7717413947566
    ],
    [
        72.47812509536743,
        163.23753631216374
    ],
    [
        71.22812509536743,
        163.112579929619
    ],
    [
        69.22812509536743,
        163.112579929619
    ],
    [
        67.72812509536743,
        163.17505812089138
    ],
    [
        65.63437509536743,
        163.112579929619
    ],
    [
        64.35312509536743,
        163.0813408339828
    ],
    [
        62.16562509536743,
        160.48849589617913
    ],
    [
        62.22812509536743,
        161.51938605217336
    ],
    [
        62.25937509536743,
        163.112579929619
    ],
    [
        62.957812547683716,
        163.16563770389996
    ],
    [
        62.239062547683716,
        164.33710379025706
    ],
    [
        62.19687509536743,
        165.893829929619
    ],
    [
        62.29062509536743,
        169.58004321468925
    ],
    [
        62.22812509536743,
        167.48702380706462
    ],
    [
        62.19687509536743,
        171.36067166595203
    ],
    [
        62.16562509536743,
        173.26625649975955
    ],
    [
        62.22812509536743,
        175.14060223793086
    ],
    [
        62.25937509536743,
        176.9212306891936
    ],
    [
        62.32187509536743,
        178.3582290884583
    ],
    [
        63.00937509536743,
        181.04479131317052
    ],
    [
        64.63437509536743,
        180.98231312189816
    ],
    [
        66.07187509536743,
        180.8573567393534
    ],
    [
        67.69687509536743,
        180.8573567393534
    ],
    [
        69.07187509536743,
        180.79487854808102
    ],
    [
        70.07187509536743,
        180.79487854808102
    ],
    [
        72.54062509536743,
        180.8261176437172
    ],
    [
        71.07187509536743,
        180.79487854808102
    ],
    [
        62.00937509536743,
        179.63903200954203
    ],
    [
        60.41562509536743,
        180.20133573099343
    ],
    [
        61.75937509536743,
        180.76363945244483
    ],
    [
        58.75937509536743,
        180.23257482662962
    ],
    [
        56.79062509536743,
        180.20133573099343
    ],
    [
        55.19687509536743,
        180.23257482662962
    ],
    [
        53.79062509536743,
        180.23257482662962
    ],
    [
        52.60312509536743,
        180.20133573099343
    ],
    [
        51.29062509536743,
        180.20133573099343
    ],
    [
        51.88437509536743,
        158.3964469769337
    ],
    [
        47.79062509536743,
        160.64566186273927
    ],
    [
        47.75937509536743,
        162.20761664454872
    ],
    [
        47.75937509536743,
        163.95700600017528
    ],
    [
        47.66562509536743,
        165.23780892125902
    ],
    [
        47.69687509536743,
        166.9559591812494
    ],
    [
        47.69687509536743,
        169.04897858887404
    ],
    [
        47.72812509536743,
        171.3919107615882
    ],
    [
        47.79062509536743,
        172.82890916085287
    ],
    [
        47.72812509536743,
        174.60953761211564
    ],
    [
        47.72812509536743,
        176.57760063719553
    ],
    [
        59.38437509536743,
        158.37059463702025
    ],
    [
        58.19687509536743,
        158.40183373265643
    ],
    [
        56.60312509536743,
        158.30811644574788
    ],
    [
        54.35312509536743,
        158.2143991588393
    ],
    [
        43.91562509536743,
        179.96009193513385
    ],
    [
        42.22812509536743,
        180.02257012640624
    ],
    [
        40.66562509536743,
        180.02257012640624
    ],
    [
        39.44687509536743,
        180.08504831767863
    ],
    [
        37.91562509536743,
        180.1162874133148
    ],
    [
        36.25937509536743,
        180.147526508951
    ],
    [
        34.91562509536743,
        180.147526508951
    ],
    [
        33.75937509536743,
        180.30372198713195
    ],
    [
        32.50937509536743,
        180.3662001784043
    ],
    [
        30.72812509536743,
        180.21000470022338
    ],
    [
        31.50937509536743,
        180.21000470022338
    ],
    [
        30.82187509536743,
        179.14787544859297
    ],
    [
        30.72812509536743,
        177.71087704932827
    ],
    [
        30.72812509536743,
        176.39883503260836
    ],
    [
        30.69687509536743,
        174.74316296389037
    ],
    [
        30.72812509536743,
        173.2749254689895
    ],
    [
        30.69687509536743,
        171.80668797408862
    ],
    [
        30.72812509536743,
        170.24473319227917
    ],
    [
        30.72812509536743,
        168.71401750610593
    ],
    [
        30.69687509536743,
        167.1833018199327
    ],
    [
        30.69687509536743,
        166.0586943770299
    ],
    [
        30.69687509536743,
        164.43426140394808
    ],
    [
        30.66562509536743,
        162.74735023959389
    ],
    [
        30.66562509536743,
        160.90424359705875
    ],
    [
        30.66562509536743,
        158.68626780688936
    ],
    [
        30.66562509536743,
        156.71820478180945
    ],
    [
        30.60312509536743,
        155.00005452181907
    ],
    [
        30.60312509536743,
        153.37562154873726
    ],
    [
        30.60312509536743,
        151.34508033238498
    ],
    [
        30.66562509536743,
        149.84560374184792
    ],
    [
        30.72812509536743,
        148.0024970993128
    ],
    [
        31.69687509536743,
        125.44787004998454
    ],
    [
        31.07187509536743,
        125.35415276307597
    ],
    [
        30.88437509536743,
        126.60371658852353
    ],
    [
        30.75937509536743,
        123.91715436381128
    ],
    [
        30.72812509536743,
        121.04315756528192
    ],
    [
        30.63437509536743,
        122.44891686891043
    ],
    [
        30.79062509536743,
        128.29062775287773
    ],
    [
        30.72812509536743,
        130.2899298735938
    ],
    [
        30.66562509536743,
        132.03931922922035
    ],
    [
        30.66562509536743,
        133.41383943721266
    ],
    [
        30.66562509536743,
        134.9757942190221
    ],
    [
        30.63437509536743,
        136.6627053833763
    ],
    [
        30.72812509536743,
        138.25589926082193
    ],
    [
        30.63437509536743,
        139.6928976600866
    ],
    [
        30.63437509536743,
        141.03617877244272
    ],
    [
        30.60312509536743,
        142.41069898043503
    ],
    [
        30.63437509536743,
        143.94141466660827
    ],
    [
        30.66562509536743,
        145.37841306587296
    ],
    [
        30.57187509536743,
        146.78417236950145
    ],
    [
        33.35312509536743,
        125.44787004998454
    ],
    [
        35.07187509536743,
        125.63530462380166
    ],
    [
        37.04062509536743,
        125.63530462380166
    ],
    [
        45.10312509536743,
        125.5728264325293
    ],
    [
        43.38437509536743,
        125.47910914562073
    ],
    [
        41.82187509536743,
        125.47910914562073
    ],
    [
        40.63437509536743,
        125.54158733689312
    ],
    [
        39.60312509536743,
        125.5103482412569
    ],
    [
        38.41562509536743,
        125.47910914562073
    ],
    [
        45.22812509536743,
        116.88835784566882
    ],
    [
        43.82187509536743,
        116.85711875003264
    ],
    [
        42.16562509536743,
        116.7009232718517
    ],
    [
        40.63437509536743,
        116.60720598494314
    ],
    [
        38.88437509536743,
        116.60720598494314
    ],
    [
        36.97812509536743,
        116.73216236748789
    ],
    [
        35.50937509536743,
        116.76340146312407
    ],
    [
        34.00937509536743,
        116.57596688930693
    ],
    [
        31.75937509536743,
        116.76340146312407
    ],
    [
        30.94687509536743,
        116.73216236748789
    ],
    [
        30.75937509536743,
        114.76409934240797
    ],
    [
        30.69687509536743,
        118.63774720129538
    ],
    [
        32.94687509536743,
        116.70092327185168
    ],
    [
        31.50937509536743,
        108.20388925880836
    ],
    [
        30.72812509536743,
        108.20388925880836
    ],
    [
        30.75937509536743,
        109.82832223189017
    ],
    [
        30.69687509536743,
        106.26706532936466
    ],
    [
        32.88437509536743,
        108.23512835444454
    ],
    [
        34.50937509536743,
        108.23512835444454
    ],
    [
        30.60312509536743,
        111.85886344824243
    ],
    [
        30.60312509536743,
        113.23338365623474
    ],
    [
        44.00937509536743,
        108.26636745008074
    ],
    [
        42.54062509536743,
        108.26636745008074
    ],
    [
        40.63437509536743,
        108.45380202389786
    ],
    [
        38.85312509536743,
        108.45380202389786
    ],
    [
        36.75937509536743,
        108.3600847369893
    ],
    [
        47.82187509536743,
        110.95292967479295
    ],
    [
        47.94687509536743,
        112.48364536096622
    ],
    [
        47.94687509536743,
        114.13931742968421
    ],
    [
        47.91562509536743,
        119.731115548562
    ],
    [
        47.88437509536743,
        122.82378601654469
    ],
    [
        47.88437509536743,
        121.04315756528192
    ],
    [
        45.35312509536743,
        98.14490046395558
    ],
    [
        47.47812509536743,
        98.0824222726832
    ],
    [
        48.00937509536743,
        98.01994408141083
    ],
    [
        44.22812509536743,
        98.17613955959177
    ],
    [
        42.50937509536743,
        98.1136613683194
    ],
    [
        40.54062509536743,
        98.05118317704702
    ],
    [
        38.85312509536743,
        98.0824222726832
    ],
    [
        37.19687509536743,
        97.98870498577463
    ],
    [
        35.66562509536743,
        97.98870498577463
    ],
    [
        34.35312509536743,
        98.0824222726832
    ],
    [
        32.57187509536743,
        97.89498769886606
    ],
    [
        31.57187509536743,
        97.89498769886606
    ],
    [
        30.79062509536743,
        97.92622679450226
    ],
    [
        30.75937509536743,
        96.33303291705663
    ],
    [
        30.82187509536743,
        99.42570338503931
    ],
    [
        30.69687509536743,
        101.48748369702777
    ],
    [
        30.72812509536743,
        103.17439486138196
    ],
    [
        30.69687509536743,
        104.7363496431914
    ],
    [
        30.69687509536743,
        93.42779702289108
    ],
    [
        30.72812509536743,
        94.739839039611
    ],
    [
        31.47812509536743,
        88.14838986037518
    ],
    [
        30.72812509536743,
        88.05467257346662
    ],
    [
        30.75937509536743,
        89.30423639891417
    ],
    [
        32.66562509536743,
        88.05467257346662
    ],
    [
        30.66562509536743,
        90.64751751127028
    ],
    [
        30.57187509536743,
        92.05327681489878
    ],
    [
        44.82187509536743,
        88.14838986037518
    ],
    [
        43.16562509536743,
        88.0546725734666
    ],
    [
        41.47812509536743,
        88.11715076473898
    ],
    [
        39.75937509536743,
        88.0859116691028
    ],
    [
        38.13437509536743,
        88.0859116691028
    ],
    [
        36.66562509536743,
        88.0546725734666
    ],
    [
        34.97812509536743,
        88.02343347783042
    ],
    [
        31.57187509536743,
        79.4951603691509
    ],
    [
        31.04062509536743,
        79.40144308224232
    ],
    [
        30.94687509536743,
        80.90091967277938
    ],
    [
        30.82187509536743,
        77.65205372661575
    ],
    [
        30.88437509536743,
        75.12168698008448
    ],
    [
        30.88437509536743,
        82.71278721967833
    ],
    [
        30.75937509536743,
        84.18102471457921
    ],
    [
        30.63437509536743,
        85.83669678329721
    ],
    [
        30.69687509536743,
        86.86758693929144
    ],
    [
        33.13437509536743,
        79.43268217787852
    ],
    [
        34.57187509536743,
        79.33896489096995
    ],
    [
        35.94687509536743,
        79.33896489096995
    ],
    [
        37.10312509536743,
        79.24524760406138
    ],
    [
        38.38437509536743,
        79.24524760406138
    ],
    [
        39.63437509536743,
        79.30772579533377
    ],
    [
        45.88437509536743,
        79.36880822803829
    ],
    [
        44.13437509536743,
        79.27509094112972
    ],
    [
        42.66562509536743,
        79.27509094112972
    ],
    [
        41.04062509536743,
        79.30633003676591
    ],
    [
        47.89375019073486,
        143.7028097267911
    ],
    [
        47.91562509536743,
        152.4447295932069
    ],
    [
        47.85312509536743,
        154.72518357464867
    ],
    [
        47.82187509536743,
        145.4784112663368
    ],
    [
        47.82187509536743,
        142.43409783849089
    ],
    [
        47.88437509536743,
        128.00163565457171
    ],
    [
        47.97812509536743,
        129.28243857565542
    ],
    [
        47.97812509536743,
        130.5007633054668
    ],
    [
        47.97812509536743,
        131.81280532218673
    ],
    [
        48.00937509536743,
        132.9998909563619
    ],
    [
        47.85312509536743,
        137.56079891924546
    ],
    [
        47.79062509536743,
        146.46394117555923
    ],
    [
        47.94687509536743,
        155.89814805768822
    ],
    [
        48.04062509536743,
        153.43025950242932
    ],
    [
        50.91562509536743,
        140.1848938570491
    ],
    [
        52.32187509536743,
        140.02869837886814
    ],
    [
        53.79062509536743,
        139.99745928323196
    ],
    [
        59.91562509536743,
        139.99745928323196
    ],
    [
        58.75937509536743,
        140.02869837886814
    ],
    [
        57.16562509536743,
        140.09117657014053
    ],
    [
        55.63437509536743,
        140.05993747450432
    ],
    [
        62.10312509536743,
        129.0325367149297
    ],
    [
        62.19687509536743,
        130.25086144474108
    ],
    [
        62.22812509536743,
        131.3129906963715
    ],
    [
        62.13437509536743,
        132.46883723491047
    ],
    [
        64.29062509536743,
        126.53340906403461
    ],
    [
        65.79062509536743,
        126.59588725530699
    ],
    [
        67.13437509536743,
        126.53340906403461
    ],
    [
        68.16562509536743,
        126.59588725530699
    ],
    [
        69.50937509536743,
        126.59588725530699
    ],
    [
        70.79062509536743,
        126.59588725530699
    ],
    [
        72.04062509536743,
        126.56464815967081
    ],
    [
        73.32187509536743,
        126.53340906403461
    ],
    [
        74.41562509536743,
        126.53340906403461
    ],
    [
        75.41562509536743,
        126.56464815967081
    ],
    [
        72.20625019073486,
        117.7560192088238
    ],
    [
        70.14375019073486,
        117.81849740009616
    ],
    [
        74.33125019073486,
        117.81849740009616
    ],
    [
        53.13437509536743,
        71.53604792007694
    ],
    [
        52.07187509536743,
        71.69224339825789
    ],
    [
        50.72812509536743,
        71.6610043026217
    ],
    [
        41.58125019073486,
        44.95285334424625
    ],
    [
        39.58125019073486,
        44.95285334424625
    ],
    [
        37.20625019073486,
        44.95285334424625
    ],
    [
        34.39375019073486,
        44.89037515297386
    ],
    [
        35.95625019073486,
        44.8278969617015
    ],
    [
        38.26875019073486,
        44.76541877042911
    ],
    [
        42.70625019073486,
        44.89037515297386
    ],
    [
        48.13437509536743,
        28.497121247953828
    ],
    [
        47.04062509536743,
        28.52836034359001
    ],
    [
        47.66562509536743,
        28.434643056681452
    ],
    [
        45.69687509536743,
        28.465882152317633
    ],
    [
        44.44687509536743,
        28.465882152317633
    ],
    [
        42.79062509536743,
        28.52836034359001
    ],
    [
        41.25937509536743,
        28.559599439226204
    ],
    [
        39.66562509536743,
        28.497121247953828
    ],
    [
        38.00937509536743,
        28.52836034359001
    ],
    [
        36.44687509536743,
        28.559599439226204
    ],
    [
        34.32187509536743,
        28.434643056681452
    ],
    [
        30.57187509536743,
        22.499214885805586
    ],
    [
        30.50937509536743,
        23.811256902525514
    ],
    [
        30.57187509536743,
        24.935864345428314
    ],
    [
        30.57187509536743,
        26.02923269269492
    ],
    [
        27.85312509536743,
        19.187870748369576
    ],
    [
        25.79062509536743,
        19.250348939641952
    ],
    [
        23.97812509536743,
        19.281588035278148
    ],
    [
        21.91562509536743,
        19.281588035278148
    ],
    [
        27.75937509536743,
        29.278098638858538
    ],
    [
        26.32187509536743,
        29.246859543222357
    ],
    [
        24.75937509536743,
        29.278098638858538
    ],
    [
        23.19687509536743,
        29.278098638858538
    ],
    [
        27.82187509536743,
        38.868500999168475
    ],
    [
        26.19687509536743,
        38.89974009480467
    ],
    [
        28.10312509536743,
        46.95942676894137
    ],
    [
        26.29062509536743,
        47.021904960213746
    ],
    [
        30.88437509536743,
        47.39677410784802
    ],
    [
        30.85312509536743,
        48.58385974202318
    ],
    [
        20.203125,
        19.187870748369576
    ],
    [
        18.140625,
        19.250348939641952
    ],
    [
        16.390625,
        19.187870748369576
    ],
    [
        15.703125,
        20.15628271309143
    ],
    [
        15.609375,
        22.249302120716067
    ],
    [
        15.671875,
        24.092408763251214
    ],
    [
        15.515625,
        25.74808083196922
    ],
    [
        15.640625,
        27.40375290068721
    ],
    [
        15.609375,
        28.715794917407138
    ],
    [
        16.171875,
        29.21562044758616
    ],
    [
        17.046875,
        29.18438135194998
    ],
    [
        21.640625,
        29.246859543222342
    ],
    [
        20.296875,
        29.12190316067759
    ],
    [
        18.546875,
        29.059424969405214
    ],
    [
        24.796875,
        38.64982732971515
    ],
    [
        23.578125,
        38.71230552098754
    ],
    [
        22.515625,
        38.71230552098754
    ],
    [
        21.015625,
        38.64982732971515
    ],
    [
        19.515625,
        38.58734913844279
    ],
    [
        15.421875,
        38.21247999080852
    ],
    [
        16.265625,
        38.68106642535135
    ],
    [
        17.765625,
        38.61858823407897
    ],
    [
        15.671875,
        29.37181592576711
    ],
    [
        15.703125,
        29.809163264673742
    ],
    [
        15.671875,
        30.777575229395595
    ],
    [
        15.671875,
        31.96466086357077
    ],
    [
        15.609375,
        33.12050740210975
    ],
    [
        15.609375,
        34.24511484501255
    ],
    [
        15.578125,
        35.36972228791534
    ],
    [
        15.578125,
        36.650525208999085
    ],
    [
        15.546875,
        37.525219886812366
    ],
    [
        14.390625,
        37.993806321355194
    ],
    [
        13.171875,
        38.15000179953614
    ],
    [
        12.046875,
        38.087523608263766
    ],
    [
        11.953125,
        39.399565624983694
    ],
    [
        12.171875,
        40.649129450431246
    ],
    [
        12.140625,
        42.11736694533211
    ],
    [
        12.984375,
        46.8657094820328
    ],
    [
        12.453125,
        46.8657094820328
    ],
    [
        12.015625,
        46.8657094820328
    ],
    [
        12.109375,
        43.52312624896061
    ],
    [
        12.078125,
        44.86640736131672
    ],
    [
        11.984375,
        45.866058421674765
    ],
    [
        11.984375,
        48.17775149875273
    ],
    [
        11.984375,
        49.27111984601933
    ],
    [
        11.984375,
        50.801835532192584
    ],
    [
        14.546875,
        46.928187673305175
    ],
    [
        16.515625,
        46.928187673305175
    ],
    [
        17.984375,
        46.928187673305175
    ],
    [
        24.765625,
        46.928187673305175
    ],
    [
        23.671875,
        46.928187673305175
    ],
    [
        22.109375,
        46.83447038639662
    ],
    [
        20.296875,
        46.83447038639662
    ],
    [
        28.359375,
        55.73761264271039
    ],
    [
        28.421875,
        61.954192674311955
    ],
    [
        26.921875,
        55.73761264271039
    ],
    [
        25.265625,
        55.675134451438026
    ],
    [
        23.921875,
        55.675134451438026
    ],
    [
        23.078125,
        55.73761264271039
    ],
    [
        22.140625,
        55.768851738346584
    ],
    [
        20.890625,
        55.70637354707421
    ],
    [
        19.515625,
        55.70637354707421
    ],
    [
        18.046875,
        55.675134451438026
    ],
    [
        16.421875,
        55.7376126427104
    ],
    [
        15.390625,
        55.7376126427104
    ],
    [
        13.984375,
        55.7376126427104
    ],
    [
        12.890625,
        55.768851738346584
    ],
    [
        12.109375,
        55.80009083398278
    ],
    [
        12.015625,
        52.20759483582107
    ],
    [
        11.984375,
        53.70707142635813
    ],
    [
        11.984375,
        54.58176610417141
    ],
    [
        12.109375,
        57.299567424519836
    ],
    [
        12.203125,
        58.67408763251214
    ],
    [
        14.171875,
        61.8292362917672
    ],
    [
        15.765625,
        61.8292362917672
    ],
    [
        17.359375,
        61.79799719613101
    ],
    [
        18.765625,
        61.766758100494826
    ],
    [
        20.328125,
        61.735519004858645
    ],
    [
        27.109375,
        62.01667086558433
    ],
    [
        25.484375,
        61.954192674311955
    ],
    [
        23.921875,
        62.01667086558433
    ],
    [
        22.703125,
        61.92295357867576
    ],
    [
        21.703125,
        61.86047538740338
    ],
    [
        12.140625,
        59.89241236232348
    ],
    [
        12.015625,
        61.01701980522628
    ],
    [
        12.671875,
        61.89171448303958
    ],
    [
        12.109375,
        61.92295357867576
    ],
    [
        12.140625,
        62.89136554339761
    ],
    [
        12.078125,
        63.953494795028035
    ],
    [
        11.984375,
        65.1405804292032
    ],
    [
        12.015625,
        66.32766606337837
    ],
    [
        12.015625,
        67.3585562193726
    ],
    [
        12.046875,
        68.32696818409445
    ],
    [
        12.078125,
        69.2953801488163
    ],
    [
        11.890625,
        70.60742216553624
    ],
    [
        11.921875,
        71.35716046080476
    ],
    [
        13.265625,
        69.92016206154008
    ],
    [
        14.359375,
        69.95140115717626
    ],
    [
        15.484375,
        69.8576838702677
    ],
    [
        16.640625,
        69.8889229659039
    ],
    [
        17.671875,
        69.95140115717628
    ],
    [
        18.859375,
        69.95140115717626
    ],
    [
        20.171875,
        69.8576838702677
    ],
    [
        21.640625,
        69.92016206154008
    ],
    [
        23.109375,
        69.8576838702677
    ],
    [
        30.828125,
        65.20305862047559
    ],
    [
        30.640625,
        66.32766606337839
    ],
    [
        30.796875,
        67.26483893246404
    ],
    [
        28.546875,
        69.8889229659039
    ],
    [
        27.421875,
        69.95140115717628
    ],
    [
        25.984375,
        70.04511844408484
    ],
    [
        29.328125,
        69.82644477463153
    ],
    [
        26.796875,
        69.92016206154008
    ],
    [
        24.921875,
        69.95140115717628
    ],
    [
        24.078125,
        69.82644477463153
    ]
];
interface Graph {
    [key: string]: { [key: string]: number };
}

const TrolleyRoute: React.FC<TrolleyRouteProps> = ({ points, setPoints }) => {
    const [activePoints, setActivePoints] = useState<Point[]>([]);
    const coordInfoRef = useRef<HTMLDivElement>(null);
    let markerCounter = 1;

    useEffect(() => {
        const img = new Image();
        img.src = '/Img/Layoutdenso.png';
    }, []);

    const getDistance = (p1: Point, p2: Point): number => {
        return Math.sqrt(Math.pow(p2[0] - p1[0], 2) + Math.pow(p2[1] - p1[1], 2));
    };

    const buildGraph = (): Graph => {
        const graph: Graph = {};
        allowedCoordinates.forEach((point1, i) => {
            const pointKey1 = `${point1[0]},${point1[1]}`;
            graph[pointKey1] = {};
            allowedCoordinates.forEach((point2, j) => {
                if (i !== j) {
                    const pointKey2 = `${point2[0]},${point2[1]}`;
                    const distance = getDistance(point1, point2);
                    if (distance < 3) {
                        graph[pointKey1][pointKey2] = distance;
                    }
                }
            });
        });
        return graph;
    };

    const findShortestPath = (start: Point, end: Point): Point[] => {
        const graph = buildGraph();
        const startKey = `${start[0]},${start[1]}`;
        const endKey = `${end[0]},${end[1]}`;
        const distances: { [key: string]: number } = {};
        const previous: { [key: string]: string | null } = {};
        const unvisited = new Set<string>();

        Object.keys(graph).forEach(vertex => {
            distances[vertex] = Infinity;
            previous[vertex] = null;
            unvisited.add(vertex);
        });
        distances[startKey] = 0;

        while (unvisited.size > 0) {
            let minDistance = Infinity;
            let current = '';
            unvisited.forEach(vertex => {
                if (distances[vertex] < minDistance) {
                    minDistance = distances[vertex];
                    current = vertex;
                }
            });

            if (current === endKey) break;
            unvisited.delete(current);

            Object.entries(graph[current] || {}).forEach(([neighbor, distance]) => {
                if (unvisited.has(neighbor)) {
                    const alt = distances[current] + distance;
                    if (alt < distances[neighbor]) {
                        distances[neighbor] = alt;
                        previous[neighbor] = current;
                    }
                }
            });
        }

        const path: Point[] = [];
        let current = endKey;
        while (current) {
            const [lat, lng] = current.split(',').map(Number);
            path.unshift([lat, lng]);
            current = previous[current] || '';
        }
        return path;
    };

    const getNearestAllowedPoint = (lat: number, lng: number): Point => {
        return allowedCoordinates.reduce((nearest, point) => {
            const distance = getDistance([lat, lng], point);
            const currentDistance = getDistance([lat, lng], nearest);
            return distance < currentDistance ? point : nearest;
        }, allowedCoordinates[0]);
    };

    const MapClickHandler: React.FC = () => {
        useMapEvents({
            click(e) {
                const { lat, lng } = e.latlng;
                const newPoint = getNearestAllowedPoint(lat, lng);

                setPoints(prev => {
                    if (prev.length === 0) {
                        return [{ x: newPoint[0], y: newPoint[1], showMarker: true }];
                    }

                    const lastPoint = prev[prev.length - 1];
                    const path = findShortestPath([lastPoint.x, lastPoint.y], newPoint);
                    const pathWithMarkers = path.slice(1).map((point, index, array) => ({
                        x: point[0],
                        y: point[1],
                        showMarker: index === array.length - 1
                    }));
                    return [...prev, ...pathWithMarkers];
                });

                if (coordInfoRef.current) {
                    coordInfoRef.current.textContent = `Clicked at: (${lat.toFixed(2)}, ${lng.toFixed(2)})`;
                }
            },
            mousemove(e) {
                const { lat, lng } = e.latlng;
                if (coordInfoRef.current) {
                    coordInfoRef.current.textContent = `Coordinates: (${lat.toFixed(2)}, ${lng.toFixed(2)})`;
                }
            }
        });
        return null;
    };

    const getNumberedIcon = (number: number) => {
        return L.divIcon({
            html: `<div style="display: flex; align-items: center; justify-content: center;
              width: 25px; height: 25px; background-color: red; border-radius: 50%; color: white;
              font-size: 14px;">${number}</div>`,
            className: '',
            iconSize: [25, 25],
            iconAnchor: [12, 12],
        });
    };

    const handleMarkerClick = (point: PointWithMarker) => {
        setPoints(prevPoints => prevPoints.filter(p => p.x !== point.x || p.y !== point.y));
        setActivePoints(prev => prev.filter(p => p[0] !== point.x || p[1] !== point.y));
    };

    const imageBounds: [[number, number], [number, number]] = [
        [0, 0],
        [100, 220],
    ];

    useEffect(() => {
        const activeMarkers: Point[] = points
        .filter(point => point.showMarker)
        .map(point => [point.x, point.y] as Point); // Cast to `Point` type
    setActivePoints(activeMarkers);
    }, [points]);
console.log("points",points)
    return (
        <Grid container spacing={2}>
            <Grid item xs={12}>
                <Paper elevation={3} sx={{ height: '550px', position: 'relative', overflow: 'hidden' }}>
                    <MapContainer
                        center={[50, 100]}
                        zoom={2}
                        minZoom={1}
                        maxZoom={3}
                        style={{ height: '100%', width: '100%' }}
                        crs={L.CRS.Simple}
                        maxBounds={[[-10, -10], [110, 210]]}
                        maxBoundsViscosity={1.0}
                    >
                        <ImageOverlay url="/Img/Layoutdenso.png" bounds={imageBounds} />
                        <MapClickHandler />

                        {points.map((point, index) => (
                            <React.Fragment key={`${point.x}-${point.y}-${index}`}>
                                {point.showMarker && (
                                    <Marker
                                        position={[point.x, point.y]}
                                        icon={getNumberedIcon(markerCounter++)}
                                        eventHandlers={{
                                            click: () => handleMarkerClick(point),
                                        }}
                                    />
                                )}
                                {index < points.length - 1 && (
                                    <Polyline
                                        positions={[
                                            [point.x, point.y],
                                            [points[index + 1].x, points[index + 1].y]
                                        ]}
                                        pathOptions={{ color: 'black' }}
                                    />
                                )}
                            </React.Fragment>
                        ))}
                    </MapContainer>

                    <Paper
                        ref={coordInfoRef}
                        sx={{
                            position: 'absolute',
                            top: 106,
                            left: 16,
                            padding: '4px 8px',
                            backgroundColor: 'rgba(255, 255, 255, 0.8)',
                            zIndex: 1000,
                        }}
                    />

                    <Box sx={{ position: 'absolute', bottom: 16, left: 16, zIndex: 1000 }}>
                        <Button
                            startIcon={<DeleteIcon />}
                            onClick={() => setPoints([])}
                            color="error"
                            disabled={points.length === 0}
                            variant="contained"
                        >
                            Clear Route
                        </Button>
                    </Box>
                </Paper>
            </Grid>
        </Grid>
    );
};

export default TrolleyRoute;
